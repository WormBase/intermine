<project name="update-wormmine" default="default" basedir=".">
    
    
    
    <taskdef resource="net/sf/antcontrib/antlib.xml">
        <classpath>
            <pathelement location="ant-contrib/ant-contrib-1.0b3.jar"/>
        </classpath>
    </taskdef>
    
    <property file="update.properties" />
    
    <target name="default" depends="get-assembly-ids">
        <echo message="${bpid-h_contortus}" />
    </target>
    
    <target name="backup-datadir" description="back up data directory">
        
    </target>
    
    <target name="get-assembly-ids" description="gets the bioproject ids of each species' assembly, generates ${assemblies-properties}">
        <exec executable="perl" failonerror="true">
            <arg value="${assemblies-parser}"/>
            <arg value="${assemblies-file}"/>
            <arg value="${assemblies-properties}"/>
        </exec>
        <property file="${assemblies-properties}"/>
    </target>
    
    <target name="get-all-fasta" description="Retrieves newest version of fasta files" depends="get-assembly-ids">
        <loadfile property="species-list" srcfile="fasta-species.txt"/>
        <echo message="${species-list}" />
        <foreach list="${species-list}" target="get-fasta" param="species" delimiter="${line.separator}" inheritall="true" />
        
    </target>
    
    <!-- Expects ${species} ex:"c_elegans" depends on get-assembly-ids -->
    <target name="get-fasta" description="retrieves a single fasta file">

        <!-- Sample URL: ftp://ftp.wormbase.org/pub/wormbase/releases/WS238/species/c_elegans/PRJNA13758/c_elegans.PRJNA13758.WS238.genomic.fa.gz -->
        <propertycopy name="bpid" from="bpid-${species}"/>
        <property name="full-url">
            ${release-url}/species/${species}/${bpid}/${species}.${bpid}.${release}.genomic.fa.gz
        </property>
        <echo message="${full-url}" />   
    </target>
    
    <target name="help">
        <loadfile property="readme" srcfile="${readme-file}" />
        <echo message="${readme}"/>
    </target>
    
    <target name="test">
        <property name="a" value="1"/>
        <property name="x" value="a"/>
        <echo message="${x}"/>
    </target>
    

    
</project>